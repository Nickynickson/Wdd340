<div class="view-container">
    <h1>Add New Vehicle</h1>

    <!-- Flash message display -->
    <% if (typeof flashMessage !=='undefined' ) { %>
        <p class="flash-message">
            <%= flashMessage %>
        </p>
        <% } %>

            <!-- Error message display -->
            <% if (errors && errors.length> 0) { %>
                <ul class="error-messages">
                    <% errors.forEach(error=> { %>
                        <li>
                            <%= error.msg %>
                        </li>
                        <% }) %>
                </ul>
                <% } %>

                    <form action="/inv/add-inventory" method="POST" id="add-vehicle-form">
                        <!-- Classification dropdown -->
                        <div class="form-group">
                            <label for="classification_id">Classification:</label>
                            <!-- The classification dropdown is generated by utilities/index.js -> buildClassificationList, ensuring option values map to classification ids -->
                            <%- classifications %>
                        </div>

                        <!-- Vehicle make -->
                        <div class="form-group">
                            <label for="inv_make">Make:</label>
                            <input type="text" id="make" name="inv_make" value="<%= stickyData?.inv_make || '' %>"
                                required>
                        </div>

                        <!-- Vehicle model -->
                        <div class="form-group">
                            <label for="inv_model">Model:</label>
                            <input type="text" id="model" name="inv_model" value="<%= stickyData?.inv_model || '' %>"
                                required>
                        </div>

                        <!-- Vehicle year -->
                        <div class="form-group">
                            <label for="inv_year">Year:</label>
                            <input type="number" id="year" name="inv_year" value="<%= stickyData?.inv_year || '' %>"
                                min="1900" max="2100" required>
                        </div>

                        <!-- Vehicle price -->
                        <div class="form-group">
                            <label for="inv_price">Price:</label>
                            <input type="number" id="price" name="inv_price" value="<%= stickyData?.inv_price || '' %>"
                                step="0.01" required>
                        </div>

                        <!-- Vehicle miles -->
                        <div class="form-group">
                            <label for="inv_miles">Miles:</label>
                            <input type="number" id="miles" name="inv_miles" value="<%= stickyData?.inv_miles || '' %>"
                                required>
                        </div>

                        <!-- Vehicle color -->
                        <div class="form-group">
                            <label for="inv_color">Color:</label>
                            <input type="text" id="color" name="inv_color" value="<%= stickyData?.inv_color || '' %>"
                                required>
                        </div>

                        <!-- Vehicle description -->
                        <div class="form-group">
                            <label for="inv_description">Description:</label>
                            <textarea id="description" name="inv_description" required
                                value="<%= stickyData?.inv_description || '' %>">
                            </textarea>
                        </div>

                        <!-- Vehicle image path -->
                        <div class="form-group">
                            <label for="inv_image">Image Path:</label>
                            <input type="text" id="image_path" name="inv_image"
                                value="<%= stickyData?.inv_image || '/images/no-image-available.png' %>" required>
                        </div>

                        <!-- Vehicle thumbnail path -->
                        <div class="form-group">
                            <label for="inv_thumbnail">Thumbnail Path:</label>
                            <input type="text" id="thumbnail_path" name="inv_thumbnail"
                                value="<%= stickyData?.inv_thumbnail || '/images/no-image-available-thumbnail.png' %>"
                                required>
                        </div>

                        <!-- Submit button -->
                        <button type="submit" class="btn">Add Vehicle</button>
                    </form>
</div>

<script>
    // Client-side validation
    document.getElementById('add-vehicle-form').addEventListener('submit', function (event) {
        const form = event.target;
        const requiredFields = ['classification_id', 'inv_make', 'inv_model', 'inv_year', 'inv_price', 'inv_miles', 'inv_color', 'inv_description', 'inv_image', 'inv_thumbnail'];
        let isValid = true;

        requiredFields.forEach(field => {
            const input = form[field];
            if (!input.value.trim()) {
                isValid = false;
                alert(`Please fill out the ${field.replace('_', ' ')} field.`);
            }
        });

        if (!isValid) {
            event.preventDefault();
        }
    });
</script>